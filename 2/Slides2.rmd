---
title: "Slides2MAP573"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Lists


```{r}
mylist <- list(myvect = c(1,5,-3), mymat = matrix(1:9, nrow = 3, ncol = 3), 
mychar = c("a","b"))

class(mylist)
length(mylist)

names(mylist)

mylist$myvect
mylist[[2]]
mylist[["mymat"]]

# an element of a list can be a list
bb <-list(onelist = mylist, y = c(1,2))
length(bb)
bb$onelist$mychar
```

## Apply

```{r }
getwd()
rm(list=ls())
library(FactoMineR)
data(decathlon)
summary(decathlon)
# don <- read.csv("data/decathlon.csv", header = T, sep = ";", row.names = 1)
```

```{r }
decathlon[1:5, ]
#View(decathlon)
#?decathlon
dim(decathlon)
rownames(decathlon)
```

```{r }
moy <- apply(decathlon[, 1:10], 2, mean)
moy
```

```{r }
moy <- colMeans(decathlon[, 1:10])
moy
```

## by

```{r }
agg <- by(decathlon[, 1:10], decathlon[, ncol(decathlon)], colMeans)
agg
agg[[1]]
res <-matrix(0,2,10)
res[1, ] <-agg[[1]]
res[2, ] <-agg[[2]]
res
colnames(res) <- colnames(decathlon[, 1:10])
```

```{r }
agg <- by(decathlon[, 1:10], decathlon[, ncol(decathlon)], apply, 2, mean)
agg
```


## Sweep
```{r }
center <-sweep(decathlon[, 1:10], 2, STATS= moy, FUN = "-")
apply(center, 2, mean)
sdev <-apply(decathlon[, 1:10], 2, sd)
centerscaled <-sweep(center, 2, STATS= sdev, FUN = "/")
apply(centerscaled, 2, sd)
```

## Function

```{r}
Tocenterscale <- function(X){
  moy <-apply(X, 2, mean)
  center <-sweep(X, 2, STATS= moy, FUN = "-")
sdev <-apply(center, 2, sd)
centerscaled <-sweep(center, 2, STATS= sdev, FUN = "/")
return(list(donscale = centerscaled, moy = moy, sdevlist = sdev))
}
```

```{r}
res <-Tocenterscale(decathlon[,1:10])
names(res)
#scale
res$moy
```

```{r }
lapply(decathlon, is.factor)
sapply(decathlon, is.factor)
```


```{r}
library(denoiseR)
imputeada


```



```{r}
Tocenterscale <- function(X){
  if (sum(sapply(X, is.numeric)) < ncol(X)) {
        stop("we need numeric varaibles only")
}
  moy <-apply(X, 2, mean)
  center <-sweep(X, 2, STATS= moy, FUN = "-")
sdev <-apply(X, 2, sd)
centerscaled <-sweep(center, 2, STATS= sdev, FUN = "/")
return(list(donscale = centerscaled, moy = moy, sdev = sdev))
}
#Tocenterscale(decathlon)
```

###

```{r}
vec <- c("A", "B", "C")
"A" %in% vec
vec <- c("B", "C")
"A" %in% vec
```


```{r}
txtvec <- c("arm","foot","lefroo", "bafoobar")
grep("foo", txtvec)
gsub("foo", txtvec, replacement = "DON")
substr("extraction", 1,4 )
```


### Graphics 
Studying the effect of a treatment on the weight of chickens.
45 eggs, 3 treatments (temperature of incubtation), then chickens were weighted. 

<!--Lors de leur mise en incubateur, 45 Ã·ufs de poules ont Ã©tÃ© rÃ©partis de faÃ§on alÃ©atoire en trois lots de 15. Trois
traitements (tempÃ©ratures d'incubation diÃ©rentes) ont ensuite Ã©tÃ© appliquÃ©s aux diÃ©rents lots. Nous supposons
qu'aprÃ¨s Ã©closion, les poussins ont tous Ã©tÃ© Ã©levÃ©s dans des conditions identiques, puis pesÃ©s Ã  un mÃªme Ã¢ge de
rÃ©fÃ©rence. Ã€ ce moment, le sexe des poussins, dont on sait a priori qu'il induit de fortes diÃ©rences de poids,
pouvait aussi Ãªtre observÃ©. Les poids considÃ©rÃ©s, exprimÃ©s en dÃ©cagrammes
On souhaite d'une part vÃ©rier qu'il y a bien un eet sexe, et on veut d'autre part savoir s'il y a un eet
traitement et une interaction entre le sexe et le traitement -->

```{r}
poussin <- read.table("/Users/josse/Documents/Cours/Polytechnique/StatwithR/bookdown-demo-master/data/poussin.txt", header=T)
summary(poussin)
```
```{r}
poussin[, 1:2] <- lapply(poussin[, 1:2], as.factor)
levels(poussin[,2]) =  c("M", "F")
summary(poussin)
colnames(poussin)[3] = "weight"
```



```{r}
hist(poussin[, "weight"], prob = TRUE, col = "red", 
main= "Distribution of the weights",  xlab="Weight") 
abline(v= median(poussin[, "weight"]), col="green", lty = 2)
```



```{r}
hist(poussin[, "weight"], prob = TRUE, col = "red", main= "Distribution of the weights",  xlab="Weight", breaks = 20) 
```

```{r}
boxplot(poussin[, "weight"],  ylab="Weight") 
```

```{r}
barplot(table(poussin$Trait))
barplot(table(poussin$Sexe))
```


```{r}
boxplot(weight ~ Trait, data  = poussin)
boxplot(weight ~ Sexe, data  = poussin)
boxplot(weight ~ Trait*Sexe, data = poussin)
table(poussin[, "Sexe"], poussin[, "Trait"])
by(poussin[, 3], (poussin[,1:2]), mean)
aggregate(poussin[, 3], list(poussin[,1], poussin[,2]), mean)
```


<!--Nous nous intÃ©ressons Ã  lâ€™Ã©quilibre des saveurs dans des cidres et plus prÃ©cisÃ©ment
Ã  la relation entre la saveur sucrÃ©e et la saveur amÃ¨re en fonction du type de cidre
(brut, demi-sec ou doux). Nous disposons de lâ€™Ã©valuation de la saveur sucrÃ©e et de
la saveur amÃ¨re fournie par un jury sensoriel (moyenne des notes, de 1 Ã  10, de 2 -->

```{r}
cider <- read.csv("/Users/josse/Documents/Cours/Polytechnique/StatwithR/bookdown-demo-master/data/cider.csv", sep = ",", header = T)
plot(Sweetness~ Bitterness, data = cider)
plot(Sweetness~ Bitterness,col=as.numeric(Type), 
data=cider, pch=15, xlab = "")
legend("topright",levels(cider$Type), 
fil=1:nlevels(cider$Type), col=1:nlevels(cidre$Type))
```


```{r}
boxplot(Sweetness~Type, data= cider)
#identify(cider[,"Type"], cider[,"Sweetness"]) click

res <- boxplot(cider[,"Sweetness"] ~ cider[,"Type"])
names(res); res$out
ind <- which((cider[cider[, "Type"]=="Sweet","Sweetness"])%in%(res$out))
rownames(cider[cider[, "Type"]=="Sweet", ])[ind]
```


## graphics with ggplot 2
```{r}
library(ggplot2)
ggplot(cider)+aes(x=Sweetness, y = ..density..)+geom_histogram()
ggplot(cider)+aes(x= Bitterness, y =Sweetness)+geom_point()
```

```{r}
ggplot(cider)+aes(x=Sweetness, y = ..density..)+geom_histogram()+ stat_bin(bins=30)
```



## options in aes relating to a variable in geom for general options
<!--
Les variables seront spÃ©cifiÃ©es dans la
fonction aes. Cette fonction admet Ã©galement des arguments tels que color, size,
fill. Ces arguments sont Ã  utiliser lorsquâ€™une couleur ou une taille est dÃ©finie Ã 
partir dâ€™une variable du jeu de donnÃ©es.-->
```{r}
ggplot(cider)+aes(x= Bitterness, y = Sweetness, col = Type)+geom_point()
```


```{r}
ggplot(cider)+aes(x=Sweetness, y = Bitterness)+geom_point(color = "red")
```

```{r}
ggplot(cider)+aes(x=Type)+geom_bar(fill="blue")
```


## arguments stats
<!--mÃªme faÃ§on, les fonctions stat_... possÃ¨dent un argument geom. En modifiant
cet argument, on changera la reprÃ©sentation graphique. Par exemple, la fonction
stat_smooth, qui permet de faire le lissage dâ€™un nuage de points, admet par dÃ©faut
lâ€™argument geom="smooth". Elle permettra de reprÃ©senter le lissage accompagnÃ©
dâ€™une bande de confiance. Si on utilise geom="line", la bande de confiance ne sera
plus reprÃ©sentÃ©e, avec geom="point" le lissage sera reprÃ©sentÃ© en pointillÃ© (voir
-->


```{r}
ggplot(cider)+aes(x=Sweetness, y = Bitterness, col = "Type")+ geom_point(size = 0.5)+ stat_smooth(method="loess",geom="line",color="blue",size=2)
```




```{r}
ggplot(cider)+aes(x=Sweetness, y = Bitterness, col = Type, group = Type)+ geom_point(size = 0.5) + stat_smooth()
```


```{r}
ggplot(cider)+aes(x=Sweetness, y = Bitterness)+ geom_point(size = 0.5) + stat_smooth(method ="lm") +  facet_grid(.~Type)

```
```{r}
library(plotly)
ggplot(cider, aes(x = Type, y = Sweetness)) +  geom_boxplot()
ggplotly()
```




```{r}
p2 <- ggplot(cider)+aes(x=Bitterness,y=Sweetness, color= Acid)+
geom_point()
p2
p2+scale_color_gradient(low="red",high="yellow")
```





